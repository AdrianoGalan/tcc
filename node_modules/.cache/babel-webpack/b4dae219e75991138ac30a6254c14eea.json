{"ast":null,"code":"import { Validators } from \"@angular/forms\";\nimport { empty } from \"rxjs\";\nimport { catchError } from \"rxjs/operators\";\nimport { AlertModalComponent } from \"src/app/shared/alert-modal/alert-modal.component\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../os.service\";\nimport * as i2 from \"src/app/funcionario/funcionario.service\";\nimport * as i3 from \"ngx-bootstrap/modal\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"@angular/router\";\nimport * as i6 from \"@angular/common\";\n\nfunction OsFinalizarComponent_div_0_form_4_option_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 33);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const f_r6 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngValue\", f_r6);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" \", f_r6.matricula, \" - \", f_r6.pessoa.nome, \" \");\n  }\n}\n\nconst _c0 = function (a0) {\n  return {\n    \"is-invalid\": a0\n  };\n};\n\nfunction OsFinalizarComponent_div_0_form_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"form\", 4);\n    i0.ɵɵlistener(\"ngSubmit\", function OsFinalizarComponent_div_0_form_4_Template_form_ngSubmit_0_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return ctx_r7.onSubmit();\n    });\n    i0.ɵɵelementStart(1, \"div\", 5);\n    i0.ɵɵelementStart(2, \"div\", 6);\n    i0.ɵɵelementStart(3, \"label\", 7);\n    i0.ɵɵtext(4, \"OS:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(5, \"input\", 8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\", 9);\n    i0.ɵɵelementStart(7, \"label\", 10);\n    i0.ɵɵtext(8, \"Maquina:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(9, \"input\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\", 5);\n    i0.ɵɵelementStart(11, \"div\", 12);\n    i0.ɵɵelementStart(12, \"label\", 13);\n    i0.ɵɵtext(13, \"Problema:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(14, \"textarea\", 14);\n    i0.ɵɵelementStart(15, \"div\", 15);\n    i0.ɵɵtext(16, \"Descreva o problema da maquina \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"div\", 5);\n    i0.ɵɵelementStart(18, \"div\", 16);\n    i0.ɵɵelementStart(19, \"label\", 17);\n    i0.ɵɵtext(20, \"Defeito:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(21, \"input\", 18);\n    i0.ɵɵelementStart(22, \"div\", 15);\n    i0.ɵɵtext(23, \"Descreva o Defeito da maquina \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"div\", 19);\n    i0.ɵɵelementStart(25, \"label\", 17);\n    i0.ɵɵtext(26, \"Responsavel:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(27, \"select\", 20);\n    i0.ɵɵtemplate(28, OsFinalizarComponent_div_0_form_4_option_28_Template, 2, 3, \"option\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(29, \"div\", 15);\n    i0.ɵɵtext(30, \"Seleciona um responsavel \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(31, \"div\", 5);\n    i0.ɵɵelementStart(32, \"div\", 12);\n    i0.ɵɵelementStart(33, \"label\", 22);\n    i0.ɵɵtext(34, \"Reparo:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(35, \"textarea\", 23);\n    i0.ɵɵelementStart(36, \"div\", 15);\n    i0.ɵɵtext(37, \"Descreva o reparo da maquina \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(38, \"div\", 5);\n    i0.ɵɵelementStart(39, \"div\", 24);\n    i0.ɵɵelementStart(40, \"label\", 25);\n    i0.ɵɵtext(41, \"Inicio Reparo:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(42, \"input\", 26);\n    i0.ɵɵelementStart(43, \"div\", 15);\n    i0.ɵɵtext(44, \"Entre com a data inicio \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(45, \"input\", 27);\n    i0.ɵɵelementStart(46, \"div\", 15);\n    i0.ɵɵtext(47, \"Entre com a data inicio \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(48, \"div\", 24);\n    i0.ɵɵelementStart(49, \"label\", 25);\n    i0.ɵɵtext(50, \"Fim Reparo:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(51, \"input\", 28);\n    i0.ɵɵelementStart(52, \"div\", 15);\n    i0.ɵɵtext(53, \"Entre com a data final \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(54, \"input\", 29);\n    i0.ɵɵelementStart(55, \"div\", 15);\n    i0.ɵɵtext(56, \"Entre com a data final \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(57, \"div\", 30);\n    i0.ɵɵelementStart(58, \"div\", 31);\n    i0.ɵɵelementStart(59, \"button\", 32);\n    i0.ɵɵtext(60, \"Finalizar\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const funcionario_r4 = ctx.ngIf;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"formGroup\", ctx_r3.formulario);\n    i0.ɵɵadvance(14);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(11, _c0, ctx_r3.submitted && ctx_r3.hasError(\"problema\")));\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(13, _c0, ctx_r3.submitted && ctx_r3.hasError(\"defeito\")));\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"compareWith\", ctx_r3.comparar)(\"ngClass\", i0.ɵɵpureFunction1(15, _c0, ctx_r3.submitted && ctx_r3.hasError(\"funcionario\")));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", funcionario_r4);\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(17, _c0, ctx_r3.submitted && ctx_r3.hasError(\"reparo\")));\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(19, _c0, ctx_r3.submitted && ctx_r3.hasError(\"iniReparoDate\")));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(21, _c0, ctx_r3.submitted && ctx_r3.hasError(\"iniReparoTime\")));\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(23, _c0, ctx_r3.submitted && ctx_r3.hasError(\"fimReparoDate\")));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(25, _c0, ctx_r3.submitted && ctx_r3.hasError(\"fimReparoTime\")));\n  }\n}\n\nfunction OsFinalizarComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 2);\n    i0.ɵɵelementStart(1, \"legend\");\n    i0.ɵɵtext(2, \"Finalizar Os\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"br\");\n    i0.ɵɵtemplate(4, OsFinalizarComponent_div_0_form_4_Template, 61, 27, \"form\", 3);\n    i0.ɵɵpipe(5, \"async\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n\n    const _r1 = i0.ɵɵreference(2);\n\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(5, 2, ctx_r0.funcionarios$))(\"ngIfElse\", _r1);\n  }\n}\n\nfunction OsFinalizarComponent_ng_template_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 34);\n    i0.ɵɵelementStart(1, \"span\", 35);\n    i0.ɵɵtext(2, \"Loading...\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport let OsFinalizarComponent = /*@__PURE__*/(() => {\n  class OsFinalizarComponent {\n    constructor(osService, funcionarioService, modalService, formBuilder, route, router) {\n      this.osService = osService;\n      this.funcionarioService = funcionarioService;\n      this.modalService = modalService;\n      this.formBuilder = formBuilder;\n      this.route = route;\n      this.router = router;\n      this.submitted = false;\n      this.inscricao = this.route.params.subscribe(params => {\n        let id = params[\"id\"];\n        this.os$ = this.osService.getOs(id).pipe(catchError(error => {\n          this.handleError(\"Erro ao carregar\");\n          this.router.navigate([\"os\"]);\n          return empty();\n        }));\n      });\n    }\n\n    ngOnInit() {\n      this.formulario = this.formBuilder.group({\n        problema: [null, [Validators.required, Validators.minLength(3), Validators.maxLength(250)]],\n        id: [null, Validators.required],\n        sigla: [null, Validators.required],\n        defeito: [null, Validators.required],\n        funcionario: [null, Validators.required],\n        reparo: [null, Validators.required],\n        iniReparoDate: [null, Validators.required],\n        iniReparoTime: [null, Validators.required],\n        fimReparoTime: [null, Validators.required],\n        fimReparoDate: [null, Validators.required]\n      });\n      this.os$.subscribe(o => {\n        this.os = o;\n\n        if (o) {\n          this.povoar();\n        }\n      });\n      this.funcionarios$ = this.funcionarioService.list();\n    }\n\n    onSubmit() {\n      this.submitted = true;\n\n      if (this.formulario.valid) {\n        let dataInicio;\n        let dataFim;\n        dataInicio = this.formulario.value['iniReparoDate'] + \" \" + this.formulario.value['iniReparoTime'];\n        dataFim = this.formulario.value['fimReparoDate'] + \" \" + this.formulario.value['fimReparoTime'];\n        this.os.defeito = this.formulario.value['defeito'];\n        this.os.manutentor = this.formulario.value['funcionario'];\n        this.os.problema = this.formulario.value['problema'];\n        this.os.reparo = this.formulario.value['reparo'];\n        this.os.dataIniManutencao = dataInicio;\n        this.os.dataFimManutencao = dataFim;\n        this.os.statusOs = 'C';\n        this.osService.salvarOs(this.os).subscribe(success => {\n          this.formulario.reset();\n          this.router.navigate(['os']);\n        }, erro => {\n          this.handleError(\"Erro ao salvar Os\");\n        });\n      }\n    }\n\n    comparar(obj1, obj2) {\n      return obj1 && obj2 ? obj1.matricula === obj2.matricula : obj1 === obj2;\n    }\n\n    povoar() {\n      var _a, _b, _c;\n\n      (_a = this.formulario.get('id')) === null || _a === void 0 ? void 0 : _a.setValue(this.os.id);\n      (_b = this.formulario.get('sigla')) === null || _b === void 0 ? void 0 : _b.setValue(this.os.maquina.sigla);\n      (_c = this.formulario.get('problema')) === null || _c === void 0 ? void 0 : _c.setValue(this.os.problema);\n    }\n\n    handleError(msg) {\n      this.bsModalRef = this.modalService.show(AlertModalComponent);\n      this.bsModalRef.content.type = \"danger\";\n      this.bsModalRef.content.message = msg;\n    }\n\n    hasError(field) {\n      var _a;\n\n      return (_a = this.formulario.get(field)) === null || _a === void 0 ? void 0 : _a.errors;\n    }\n\n  }\n\n  OsFinalizarComponent.ɵfac = function OsFinalizarComponent_Factory(t) {\n    return new (t || OsFinalizarComponent)(i0.ɵɵdirectiveInject(i1.OsService), i0.ɵɵdirectiveInject(i2.FuncionarioService), i0.ɵɵdirectiveInject(i3.BsModalService), i0.ɵɵdirectiveInject(i4.FormBuilder), i0.ɵɵdirectiveInject(i5.ActivatedRoute), i0.ɵɵdirectiveInject(i5.Router));\n  };\n\n  OsFinalizarComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: OsFinalizarComponent,\n    selectors: [[\"app-os-finalizar\"]],\n    decls: 3,\n    vars: 2,\n    consts: [[\"class\", \"container\", 4, \"ngIf\", \"ngIfElse\"], [\"loading\", \"\"], [1, \"container\"], [3, \"formGroup\", \"ngSubmit\", 4, \"ngIf\", \"ngIfElse\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"form-row\"], [1, \"form-group\", \"col-md-3\"], [\"for\", \"osNumero\"], [\"type\", \"text\", \"readonly\", \"\", \"formControlName\", \"id\", \"id\", \"osNumero\", 1, \"form-control\"], [1, \"form-group\", \"col-md-6\"], [\"for\", \"maquina\"], [\"type\", \"text\", \"readonly\", \"\", \"formControlName\", \"sigla\", \"id\", \"maquina\", 1, \"form-control\"], [1, \"form-group\", \"col-md-9\"], [\"for\", \"problema\"], [\"type\", \"text\", \"id\", \"problema\", \"placeholder\", \"Descreva o problema da maquina\", \"formControlName\", \"problema\", 1, \"form-control\", 2, \"margin\", \"5px\", 3, \"ngClass\"], [1, \"invalid-feedback\"], [1, \"form-group\", \"col-md-5\"], [\"for\", \"defeito\"], [\"type\", \"text\", \"formControlName\", \"defeito\", \"id\", \"defeito\", 1, \"form-control\", 3, \"ngClass\"], [1, \"col-sm-4\"], [\"id\", \"funcionario\", \"formControlName\", \"funcionario\", 1, \"form-control\", 2, \"margin\", \"5px\", 3, \"compareWith\", \"ngClass\"], [3, \"ngValue\", 4, \"ngFor\", \"ngForOf\"], [\"for\", \"reparo\"], [\"type\", \"text\", \"id\", \"reparo\", \"placeholder\", \"Descreva o reparo da maquina\", \"formControlName\", \"reparo\", 1, \"form-control\", 2, \"margin\", \"5px\", 3, \"ngClass\"], [1, \"form-group\", \"col-md-2\"], [\"for\", \"iniReparo\"], [\"type\", \"date\", \"formControlName\", \"iniReparoDate\", \"id\", \"iniReparo\", 1, \"form-control\", 3, \"ngClass\"], [\"type\", \"time\", \"formControlName\", \"iniReparoTime\", \"id\", \"iniReparo\", 1, \"form-control\", 3, \"ngClass\"], [\"type\", \"date\", \"formControlName\", \"fimReparoDate\", \"id\", \"iniReparo\", 1, \"form-control\", 3, \"ngClass\"], [\"type\", \"time\", \"formControlName\", \"fimReparoTime\", \"id\", \"iniReparo\", 1, \"form-control\", 3, \"ngClass\"], [1, \"form-group\", \"row\"], [1, \"col-sm-9\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\"], [3, \"ngValue\"], [\"role\", \"status\", 1, \"spinner-border\"], [1, \"sr-only\"]],\n    template: function OsFinalizarComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, OsFinalizarComponent_div_0_Template, 6, 4, \"div\", 0);\n        i0.ɵɵtemplate(1, OsFinalizarComponent_ng_template_1_Template, 3, 0, \"ng-template\", null, 1, i0.ɵɵtemplateRefExtractor);\n      }\n\n      if (rf & 2) {\n        const _r1 = i0.ɵɵreference(2);\n\n        i0.ɵɵproperty(\"ngIf\", ctx.os$)(\"ngIfElse\", _r1);\n      }\n    },\n    directives: [i6.NgIf, i4.ɵNgNoValidate, i4.NgControlStatusGroup, i4.FormGroupDirective, i4.DefaultValueAccessor, i4.NgControlStatus, i4.FormControlName, i6.NgClass, i4.SelectControlValueAccessor, i6.NgForOf, i4.NgSelectOption, i4.ɵNgSelectMultipleOption],\n    pipes: [i6.AsyncPipe],\n    styles: [\"\"]\n  });\n  return OsFinalizarComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}